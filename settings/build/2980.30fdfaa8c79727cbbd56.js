"use strict";(self.webpackChunkcomplianz_gdpr=self.webpackChunkcomplianz_gdpr||[]).push([[2980,17,8414,5207,5228],{50599:(e,t,a)=>{a.r(t),a.d(t,{default:()=>p});var l=a(51609),n=a(5207),c=a(86087),o=a(27723),r=a(32636),i=a(4219),s=a(45111),d=a(90017),m=a(59387),u=a(25228);const p=(0,c.memo)((({label:e,field:t})=>{const{fields:a,fileName:p,fetching:g,loadingFields:_,updating:f,regions:b,documentsLoaded:h,resetEditDocumentId:E,savedDocument:z,fetchData:y,fetchFields:v,updateField:w,save:N,editDocumentId:k,region:C,setRegion:F}=(0,n.default)(),[D,A]=(0,c.useState)(!0),[L,S]=(0,c.useState)(!1),[R,I]=(0,c.useState)(0),{allRequiredFieldsCompleted:q,fetchAllFieldsCompleted:x,fieldsLoaded:T,showSavedSettingsNotice:U}=(0,i.default)();let j=React.createRef();(0,c.useEffect)((()=>{k&&I(0),k&&j.current&&j.current.scrollIntoView({behavior:"smooth",block:"start"})}),[k]),(0,c.useEffect)((()=>{!h&&cmplz_settings.is_premium&&y()}),[h]),(0,c.useEffect)((()=>{x()}),[T]),(0,c.useEffect)((()=>{A(""===C)}),[C,g,k]);const H=async()=>{if(""!==z.downloadUrl){S(!0);const e=z.download_url;try{let t=new XMLHttpRequest;t.responseType="blob",t.open("get",e,!0),t.send(),t.onreadystatechange=function(){if(4===this.readyState&&200===this.status){let e=window.URL.createObjectURL(this.response),t=window.document.createElement("a");t.setAttribute("href",e),t.setAttribute("download",z.title),window.document.body.appendChild(t),t.click(),S(!1),setTimeout((function(){window.URL.revokeObjectURL(e)}),6e4)}}}catch(e){console.error(e),S(!1)}}},M=async()=>{await N(C),U()};(0,c.useEffect)((()=>{""===C||g||A(!1)}),[C,g]);let O=a.filter((e=>void 0===e.conditionallyDisabled||!1===e.conditionallyDisabled)),P=Math.ceil(O.length/5),V=(e=>{const t=5*(R-1),a=t+5;return e.slice(t,a)})(a);return(0,l.createElement)(l.Fragment,null,!q&&(0,l.createElement)("div",{className:"cmplz-locked"},(0,l.createElement)("div",{className:"cmplz-locked-overlay"},(0,l.createElement)("span",{className:"cmplz-task-status cmplz-warning"},(0,o.__)("Incomplete","complianz-gdpr")),(0,l.createElement)("span",null,(0,o.__)("The wizard has not been completed yet, but this field requires information from the wizard. Please complete the wizard first.","complianz-gdpr")))),0===R&&(0,l.createElement)(l.Fragment,null,k&&(0,l.createElement)("div",{className:"cmplz-selected-document"},p),(0,l.createElement)(m.default,{id:"region_for_databreaches",label:(0,o.__)("Region","complianz-gdpr"),required:!0,type:"select"}),(0,l.createElement)(u.default,{innerRef:j,disabled:f,onChange:e=>F(e),options:b,value:C,required:!0}),(0,l.createElement)("div",{className:"cmplz-table-header"},(0,l.createElement)(m.default,{id:"region_for_databreaches",label:(0,o.__)("Create Data Breach report","complianz-gdpr"),type:"button"}),(0,l.createElement)("div",{className:"cmplz-table-header-controls"},k&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)("button",{disabled:f,className:"button button-default",onClick:()=>{E(),I(0)}},(0,o.__)("Cancel","complianz-gdpr")),(0,l.createElement)("button",{disabled:f,className:"button button-primary",onClick:()=>I(R+1)},(0,o.__)("Next","complianz-gdpr")),(0,l.createElement)("button",{disabled:f,className:"button button-primary",onClick:()=>M()},(0,o.__)("Save","complianz-gdpr"))),!k&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)("button",{disabled:D||_,className:"button button-primary",onClick:()=>(async()=>{await v(C),I(1)})()},(0,o.__)("Create","complianz-gdpr"),_&&(0,l.createElement)(s.default,{name:"loading",color:"grey"})))))),R>0&&(0,l.createElement)(l.Fragment,null,R<=P&&V.map(((e,t)=>(0,l.createElement)(r.default,{key:t,index:t,field:e,isCustomField:!0,customChangeHandler:(e,t)=>((e,t)=>{w(e,t)})(e,t)}))),R>P&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)(d.default,null)),(0,l.createElement)("div",{className:"cmplz-table-header"},(0,l.createElement)("div",{className:"cmplz-table-header-controls"},(0,l.createElement)("button",{disabled:f,className:"button button-default",onClick:()=>{E(),I(0)}},R<=P&&(0,o.__)("Cancel","complianz-gdpr"),R>P&&(0,o.__)("Exit","complianz-gdpr")),R<=P&&(0,l.createElement)("button",{className:"button button-default",onClick:()=>I(R-1)},(0,o.__)("Previous","complianz-gdpr")),R<P&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)("button",{className:"button button-primary",onClick:()=>I(R+1)},(0,o.__)("Next","complianz-gdpr"))),R===P&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)("button",{className:"button button-primary",onClick:()=>(async()=>{await N(C),U(),I(R+1)})()},(0,o.__)("Finish","complianz-gdpr"),f&&(0,l.createElement)(s.default,{name:"loading",color:"grey"}))),R>P&&z&&z.has_to_be_reported&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)("button",{disabled:L,className:"button button-primary",onClick:()=>H()},(0,o.__)("Download","complianz-gdpr"))),k&&R<P&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)("button",{disabled:f,className:"button button-primary",onClick:()=>M()},(0,o.__)("Save","complianz-gdpr")))))))}))},90017:(e,t,a)=>{a.r(t),a.d(t,{default:()=>s});var l=a(51609),n=a(5207),c=a(86087),o=a(27723),r=a(4219),i=a(38414);const s=(0,c.memo)((()=>{const{savedDocument:e,conclusions:t}=(0,n.default)(),{addHelpNotice:a}=(0,r.default)();return(0,c.useEffect)((()=>{e.has_to_be_reported&&a("create-data-breach-reports","warning",(0,o.__)("This wizard is intended to provide a general guide to a possible data breach.","complianz-gdpr")+" "+(0,o.__)("Specialist legal advice should be sought about your specific circumstances.","complianz-gdpr"),(0,o.__)("Specialist legal advice required","complianz-gdpr"),!1)}),[e]),(0,l.createElement)(l.Fragment,null,(0,l.createElement)("div",{id:"cmplz-conclusion"},(0,l.createElement)("h3",null,(0,o.__)("Your dataleak report:","complianz-gdpr")),(0,l.createElement)("ul",{className:"cmplz-conclusion__list"},t.length>0&&t.map(((e,t)=>(0,l.createElement)(i.default,{conclusion:e,key:t,delay:1e3*t}))))))}))},38414:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var l=a(51609),n=a(86087),c=a(45111),o=a(42838),r=a.n(o);const i=(0,n.memo)((({conclusion:e,delay:t})=>{const[a,o]=(0,n.useState)(!0);(0,n.useEffect)((()=>{setTimeout((()=>{i()}),t)}));const i=()=>{o(!1)};let s="green";return"warning"===e.report_status&&(s="orange"),"error"===e.report_status&&(s="red"),(0,l.createElement)(l.Fragment,null,a&&(0,l.createElement)("li",{className:"cmplz-conclusion__check icon-loading"},(0,l.createElement)(c.default,{name:"loading",color:"grey"}),(0,l.createElement)("div",{className:"cmplz-conclusion__check--report-text"}," ",e.check_text," ")),!a&&(0,l.createElement)("li",{className:"cmplz-conclusion__check icon-"+e.report_status},(0,l.createElement)(c.default,{name:e.report_status,color:s}),(0,l.createElement)("div",{className:"cmplz-conclusion__check--report-text",dangerouslySetInnerHTML:{__html:r().sanitize(e.report_text)}}," ")))}))},5207:(e,t,a)=>{a.r(t),a.d(t,{default:()=>r});var l=a(81621),n=a(16535),c=a(9588),o=a(73710);const r=(0,l.vt)(((e,t)=>({documentsLoaded:!1,savedDocument:{},conclusions:[],region:"",fileName:"",fetching:!1,updating:!1,loadingFields:!1,documents:[],regions:[],fields:[],editDocumentId:!1,resetEditDocumentId:t=>{e({editDocumentId:!1,region:""})},editDocument:async t=>{e({updating:!0}),await c.doAction("load_databreach_report",{id:t}).then((t=>{e({fields:t.fields,region:t.region,updating:!1,fileName:t.file_name})})).catch((e=>{console.error(e)})),e({editDocumentId:t})},setRegion:t=>{e({region:t})},updateField:(a,l)=>{let c=!1,r=!1;e((0,n.Ay)((e=>{e.fields.forEach((function(e,t){e.id===a&&(r=t,c=!0)})),!1!==r&&(e.fields[r].value=l)})));let i=(0,o.updateFieldsListWithConditions)(t().fields);e({fields:i})},save:async a=>{e({updating:!0});let l=t().editDocumentId,n=0;await c.doAction("save_databreach_report",{fields:t().fields,region:a,post_id:l}).then((t=>(n=t.post_id,e({updating:!1,conclusions:t.conclusions}),t))).catch((e=>{console.error(e)})),await t().fetchData();let o=t().documents.filter((e=>e.id===n));o.length>0&&e({savedDocument:o[0]})},deleteDocuments:async a=>{let l=t().documents.filter((e=>a.includes(e.id)));e((e=>({documents:e.documents.filter((e=>!a.includes(e.id)))})));let n={};n.documents=l,await c.doAction("delete_databreach_report",n).then((e=>e)).catch((e=>{console.error(e)}))},fetchData:async()=>{if(t().fetching)return;e({fetching:!0});const{documents:a,regions:l}=await c.doAction("get_databreach_reports",{}).then((e=>e)).catch((e=>{console.error(e)}));e((e=>({documentsLoaded:!0,documents:a,regions:l,fetching:!1})))},fetchFields:async t=>{let a={region:t};e({loadingFields:!0});const{fields:l}=await c.doAction("get_databreach_report_fields",a).then((e=>e)).catch((e=>{console.error(e)}));let n=(0,o.updateFieldsListWithConditions)(l);e((e=>({fields:n,loadingFields:!1})))}})))},25228:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var l=a(51609),n=a(86087),c=a(45296),o=a(45111),r=a(27723);const i=(0,n.memo)((({value:e=!1,onChange:t,required:a,defaultValue:n,disabled:i,options:s={},canBeEmpty:d=!0,label:m})=>{if(Array.isArray(s)){let e={};s.map((t=>{e[t.value]=t.label})),s=e}return d?(""===e||!1===e||0===e)&&(e="0",s={0:(0,r.__)("Select an option","complianz-gdpr"),...s}):e||(e=Object.keys(s)[0]),(0,l.createElement)("div",{className:"cmplz-input-group cmplz-select-group",key:m},(0,l.createElement)(c.bL,{value:e,defaultValue:n,onValueChange:t,required:a,disabled:i&&!Array.isArray(i)},(0,l.createElement)(c.l9,{className:"cmplz-select-group__trigger"},(0,l.createElement)(c.WT,null),(0,l.createElement)(o.default,{name:"chevron-down"})),(0,l.createElement)(c.UC,{className:"cmplz-select-group__content",position:"popper"},(0,l.createElement)(c.PP,{className:"cmplz-select-group__scroll-button"},(0,l.createElement)(o.default,{name:"chevron-up"})),(0,l.createElement)(c.LM,{className:"cmplz-select-group__viewport"},(0,l.createElement)(c.YJ,null,Object.entries(s).map((([e,t])=>(0,l.createElement)(c.q7,{disabled:Array.isArray(i)&&i.includes(e),className:"cmplz-select-group__item",key:e,value:e},(0,l.createElement)(c.p4,null,t)))))),(0,l.createElement)(c.wn,{className:"cmplz-select-group__scroll-button"},(0,l.createElement)(o.default,{name:"chevron-down"})))))}))}}]);