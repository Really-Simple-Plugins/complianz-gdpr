"use strict";(self.webpackChunkcomplianz_gdpr=self.webpackChunkcomplianz_gdpr||[]).push([[5023,800,4759,2921],{10800:(e,t,a)=>{a.r(t),a.d(t,{default:()=>A});var r=a(51609),s=a(86087),l=a(58168),n=a(9957),c=a(91071),i=a(62133),o=a(81351),d=a(85357),u=a(31769),p=a(12579);const h="Switch",[m,g]=(0,i.A)(h),[b,f]=m(h),_=(0,r.forwardRef)(((e,t)=>{const{__scopeSwitch:a,name:s,checked:i,defaultChecked:d,required:u,disabled:h,value:m="on",onCheckedChange:g,...f}=e,[_,E]=(0,r.useState)(null),k=(0,c.s)(t,(e=>E(e))),w=(0,r.useRef)(!1),A=!_||Boolean(_.closest("form")),[S=!1,z]=(0,o.i)({prop:i,defaultProp:d,onChange:g});return(0,r.createElement)(b,{scope:a,checked:S,disabled:h},(0,r.createElement)(p.sG.button,(0,l.A)({type:"button",role:"switch","aria-checked":S,"aria-required":u,"data-state":y(S),"data-disabled":h?"":void 0,disabled:h,value:m},f,{ref:k,onClick:(0,n.m)(e.onClick,(e=>{z((e=>!e)),A&&(w.current=e.isPropagationStopped(),w.current||e.stopPropagation())}))})),A&&(0,r.createElement)(v,{control:_,bubbles:!w.current,name:s,value:m,checked:S,required:u,disabled:h,style:{transform:"translateX(-100%)"}}))})),v=e=>{const{control:t,checked:a,bubbles:s=!0,...n}=e,c=(0,r.useRef)(null),i=(0,d.Z)(a),o=(0,u.X)(t);return(0,r.useEffect)((()=>{const e=c.current,t=window.HTMLInputElement.prototype,r=Object.getOwnPropertyDescriptor(t,"checked").set;if(i!==a&&r){const t=new Event("click",{bubbles:s});r.call(e,a),e.dispatchEvent(t)}}),[i,a,s]),(0,r.createElement)("input",(0,l.A)({type:"checkbox","aria-hidden":!0,defaultChecked:a},n,{tabIndex:-1,ref:c,style:{...e.style,...o,position:"absolute",pointerEvents:"none",opacity:0,margin:0}}))};function y(e){return e?"checked":"unchecked"}const E=_,k=(0,r.forwardRef)(((e,t)=>{const{__scopeSwitch:a,...s}=e,n=f("SwitchThumb",a);return(0,r.createElement)(p.sG.span,(0,l.A)({"data-state":y(n.checked),"data-disabled":n.disabled?"":void 0},s,{ref:t}))}));var w=a(4219);const A=(0,s.memo)((({value:e,onChange:t,required:a,disabled:s,className:l,label:n,id:c})=>{const{getField:i}=(0,w.default)();let o=e;return"0"!==e&&"1"!==e||(o="1"===e),(0,r.createElement)("div",{className:"cmplz-input-group cmplz-switch-group"},(0,r.createElement)(E,{className:"cmplz-switch-root "+l,checked:o,onCheckedChange:e=>{"banner"===i(c).data_target&&(e=e?"1":"0"),t(e)},disabled:s,required:a},(0,r.createElement)(k,{className:"cmplz-switch-thumb"})))}))},34759:(e,t,a)=>{a.r(t),a.d(t,{default:()=>n});var r=a(81621),s=a(16535),l=a(9588);const n=(0,r.vt)(((e,t)=>({integrationsLoaded:!1,fetching:!1,services:[],plugins:[],scripts:[],placeholders:[],blockedScripts:[],setScript:(t,a)=>{e((0,s.Ay)((e=>{if("block_script"===a){let a=e.blockedScripts;if(t.urls){for(const[e,r]of Object.entries(t.urls)){if(!r||0===r.length)continue;let e=!1;for(const[t,s]of Object.entries(a))r===t&&(e=!0);e||(a[r]=r)}e.blockedScripts=a}}const r=e.scripts[a].findIndex((e=>e.id===t.id));-1!==r&&(e.scripts[a][r]=t)})))},fetchIntegrationsData:async()=>{if(t().fetching)return;e({fetching:!0});const{services:a,plugins:r,scripts:s,placeholders:l,blocked_scripts:n}=await c();let i=s;i.block_script&&i.block_script.length>0&&i.block_script.forEach(((e,t)=>{e.id=t})),i.add_script&&i.add_script.length>0&&i.add_script.forEach(((e,t)=>{e.id=t})),i.whitelist_script&&i.whitelist_script.length>0&&i.whitelist_script.forEach(((e,t)=>{e.id=t})),e((()=>({integrationsLoaded:!0,services:a,plugins:r,scripts:i,fetching:!1,placeholders:l,blockedScripts:n})))},addScript:a=>{e({fetching:!0}),t().scripts[a]&&Array.isArray(t().scripts[a])||e((0,s.Ay)((e=>{e.scripts[a]=[]}))),e((0,s.Ay)((e=>{e.scripts[a].push({name:"general",id:e.scripts[a].length,enable:!0})})));let r=t().scripts;return l.doAction("update_scripts",{scripts:r}).then((t=>(e({fetching:!1}),t))).catch((e=>{console.error(e)}))},saveScript:(a,r)=>{e({fetching:!0}),t().scripts[r]&&Array.isArray(t().scripts[r])||e((0,s.Ay)((e=>{e.scripts[r]=[]}))),e((0,s.Ay)((e=>{const t=e.scripts[r].findIndex((e=>e.id===a.id));-1!==t&&(e.scripts[r][t]=a)})));let n=t().scripts;return l.doAction("update_scripts",{scripts:n}).then((t=>(e({fetching:!1}),t))).catch((e=>{console.error(e)}))},deleteScript:(a,r)=>{e({fetching:!0}),t().scripts[r]&&Array.isArray(t().scripts[r])||e((0,s.Ay)((e=>{e.scripts[r]=[]}))),e((0,s.Ay)((e=>{const t=e.scripts[r].findIndex((e=>e.id===a.id));-1!==t&&e.scripts[r].splice(t,1)})));let n=t().scripts;return l.doAction("update_scripts",{scripts:n}).then((t=>(e({fetching:!1}),t))).catch((e=>{console.error(e)}))},updatePluginStatus:async(t,a)=>{e({fetching:!0}),e((0,s.Ay)((e=>{const r=e.plugins.findIndex((e=>e.id===t));-1!==r&&(e.plugins[r].enabled=a)})));const r=await l.doAction("update_plugin_status",{plugin:t,enabled:a}).then((e=>e)).catch((e=>{console.error(e)}));return e({fetching:!1}),r},updatePlaceholderStatus:async(t,a,r)=>{e({fetching:!0}),r&&e((0,s.Ay)((e=>{const r=e.plugins.findIndex((e=>e.id===t));-1!==r&&(e.plugins[r].placeholder=a?"enabled":"disabled")})));const n=await l.doAction("update_placeholder_status",{id:t,enabled:a}).then((e=>e)).catch((e=>{console.error(e)}));return e({fetching:!1}),n}}))),c=()=>l.doAction("get_integrations_data",{}).then((e=>e)).catch((e=>{console.error(e)}))},85023:(e,t,a)=>{a.r(t),a.d(t,{default:()=>u});var r=a(51609),s=a(34759),l=a(86087),n=a(27723),c=a(4219),i=a(32921),o=a(52043),d=a(10800);const u=(0,l.memo)((()=>{const{updatePlaceholderStatus:e,integrationsLoaded:t,services:u,fetchIntegrationsData:p}=(0,s.default)(),[h,m]=(0,l.useState)([]),[g,b]=(0,l.useState)(""),[f,_]=(0,l.useState)(!1),[v,y]=(0,l.useState)(!1),[E,k]=(0,l.useState)(""),[w,A]=(0,l.useState)(""),{updateField:S,getField:z,getFieldValue:C,saveFields:F,setChangedField:N,addHelpNotice:x}=(0,c.default)(),{selectedSubMenuItem:I}=(0,o.default)(),[P,L]=(0,l.useState)(null);(0,l.useEffect)((()=>{a.e(3757).then(a.bind(a,83757)).then((({default:e})=>{L((()=>e))}))}),[]),(0,l.useEffect)((()=>{t||p(),t&&(1==C("safe_mode")?(k((0,n.__)("Safe Mode enabled. To manage integrations, disable Safe Mode under Tools - Support.","complianz-gdpr")),_(!0)):"yes"!==C("uses_thirdparty_services")&&"yes"!==C("uses_social_media")&&"yes"!==C("uses_ad_cookies")&&(k((0,n.__)("Third-party services and social media are marked as not being used on your website in the wizard.","complianz-gdpr")),A("#wizard/services"),_(!0)))}),[t]),(0,l.useEffect)((()=>{R()}),[u]);const R=()=>{let e=[...u];e.forEach((function(t,a){let r={...t},s=z(t.source);if("multicheckbox"===s.type){let e=s.value;Array.isArray(e)||(e=[]),r.enabled=e.includes(t.id)}else r.enabled="yes"===s.value;e[a]=r})),m(e);let t="yes"===C("block_recaptcha_service"),a=u.filter((e=>"google-recaptcha"===e.id))[0];t&&a&&a.enabled&&x("integrations-services","warning",(0,n.__)("reCaptcha is connected and will be blocked before consent. To change your settings, disable reCaptcha in the list.","complianz-gdpr"),(0,n.__)("reCaptcha blocking enabled","complianz-gdpr"),"#wizard/services")};(0,l.useEffect)((()=>{if(0===h.length)return;let e="yes";0===h.filter((e=>!0===e.enabled&&"thirdparty_services_on_site"===e.source)).length&&(e="no"),C("uses_thirdparty_services")!==e&&(S("uses_thirdparty_services",e),N("uses_thirdparty_services",e));let t="yes";0===h.filter((e=>!0===e.enabled&&"socialmedia_on_site"===e.source)).length&&(t="no"),C("uses_social_media")!==t&&(S("uses_social_media",t),N("uses_social_media",t))}),[h]);const T=[{name:(0,n.__)("Service","complianz-gdpr"),selector:e=>e.label,sortable:!0,grow:5},{name:(0,n.__)("Placeholder","complianz-gdpr"),selector:e=>e.placeholderControl,sortable:!0,sortFunction:(e,t)=>{const a=e.placeholder,r=t.placeholder;return a>r?1:r>a?-1:0},grow:2},{name:(0,n.__)("Status","complianz-gdpr"),selector:e=>e.enabledControl,sortable:!0,sortFunction:(e,t)=>{const a=e.enabled,r=t.enabled;return a>r?1:r>a?-1:0},grow:1,right:!0}];let q=h.filter((e=>e.label.toLowerCase().includes(g.toLowerCase())));return q.sort(((e,t)=>e.label<t.label?-1:e.label>t.label?1:0)),q.forEach((t=>{let a=C(t.source);Array.isArray(a)?t.enabled=a.includes(t.id):t.enabled="yes"===a,t.enabledControl=(0,r.createElement)(d.default,{disabled:v,value:t.enabled,onChange:e=>(async(e,t)=>{y(!0);let a,r=z(e.source);if("multicheckbox"===r.type){let s=r.value;Array.isArray(s)||(s=[]),a=[...s],Array.isArray(a)||(a=[]),t?a.push(e.id):a=a.filter((t=>t!==e.id))}else a=t?"yes":"no";S(e.source,a),N(e.source,a),await F(I,!1),await p(),y(!1)})(t,e),className:"cmplz-switch-input-tiny"}),t.placeholderControl=(0,r.createElement)(r.Fragment,null," ","none"!==t.placeholder&&t.enabled&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)(d.default,{disabled:v,value:"enabled"===t.placeholder,onChange:a=>(async(t,a)=>{y(!0);let r=[...h],s=r.findIndex((e=>e.id===t.id));r[s].placeholder=a?"enabled":"disabled",m(r),await e(t.id,a),y(!1)})(t,a),className:"cmplz-switch-input-tiny"})))})),(0,r.createElement)(r.Fragment,null,(0,r.createElement)("p",null,(0,n.__)("Enabled services will be blocked on the front-end of your website until the user has given consent (opt-in), or after the user has revoked consent (opt-out). When possible a placeholder is activated. You can also disable or configure the placeholder to your liking.","complianz-gdpr"),(0,i.default)("https://complianz.io/blocking-recaptcha-manually/")),(0,r.createElement)("div",{className:"cmplz-table-header"},(0,r.createElement)("div",{className:"cmplz-table-header-controls"},(0,r.createElement)("input",{type:"text",placeholder:(0,n.__)("Search","complianz-gdpr"),value:g,onChange:e=>b(e.target.value)}))),(f||0===q.length)&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)("div",{className:"cmplz-settings-overlay"},(0,r.createElement)("div",{className:"cmplz-settings-overlay-message"},E,w&&(0,r.createElement)(r.Fragment,null," ",(0,r.createElement)("a",{href:w},(0,n.__)("View services","complianz-gdpr")))))),0===q.length&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)("div",{className:"cmplz-integrations-placeholder"},(0,r.createElement)("div",null),(0,r.createElement)("div",null),(0,r.createElement)("div",null),(0,r.createElement)("div",null),(0,r.createElement)("div",null),(0,r.createElement)("div",null))),!f&&q.length>0&&P&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)(P,{columns:T,data:q,dense:!0,pagination:!0,paginationPerPage:5,noDataComponent:(0,r.createElement)("div",{className:"cmplz-no-documents"},(0,n.__)("No services","complianz-gdpr")),persistTableHead:!0,theme:"really-simple-plugins",customStyles:{headCells:{style:{paddingLeft:"0",paddingRight:"0"}},cells:{style:{paddingLeft:"0",paddingRight:"0"}}}})))}))},32921:(e,t,a)=>{a.r(t),a.d(t,{default:()=>n});var r=a(51609),s=a(27723),l=a(44124);const n=e=>(0,r.createElement)(r.Fragment,null," ",(0,r.createElement)(l.default,{url:e,target:"_blank",rel:"noopener noreferrer",text:(0,s.__)("For more information, please read this %sarticle%s.","complianz-gdpr")})," ")},85357:(e,t,a)=>{a.d(t,{Z:()=>s});var r=a(51609);function s(e){const t=(0,r.useRef)({value:e,previous:e});return(0,r.useMemo)((()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous)),[e])}}}]);