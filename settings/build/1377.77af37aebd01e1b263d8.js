"use strict";(self.webpackChunkcomplianz_gdpr=self.webpackChunkcomplianz_gdpr||[]).push([[1377,2175,9510,881,382],{32175:function(e,t,n){n.r(t),n.d(t,{UseCookieScanData:function(){return r}});var a=n(30270),o=n(48399);const r=(0,a.Ue)(((e,t)=>({initialLoadCompleted:!1,setInitialLoadCompleted:t=>e({initialLoadCompleted:t}),iframeLoaded:!1,loading:!1,nextPage:!1,progress:0,cookies:[],lastLoadedIframe:"",setIframeLoaded:t=>e({iframeLoaded:t}),setLastLoadedIframe:t=>e((e=>({lastLoadedIframe:t}))),setProgress:t=>e({progress:t}),fetchProgress:()=>(e({loading:!0}),o.doAction("get_scan_progress",{}).then((t=>(e({initialLoadCompleted:!0,loading:!1,nextPage:t.next_page,progress:t.progress,cookies:t.cookies}),t))))})))},71377:function(e,t,n){n.r(t);var a=n(69307),o=n(39510),r=n(65736),l=n(23361),c=n(382);t.default=(0,a.memo)((()=>{const{documents:e,documentsLoaded:t,fetchData:i,deleteDocuments:s,editDocument:d}=(0,o.default)(),[u,m]=(0,a.useState)(""),[p]=(0,a.useState)(""),[f,g]=(0,a.useState)(""),[h,b]=(0,a.useState)([]),[_,E]=(0,a.useState)(!1),[v,k]=(0,a.useState)({}),[y,C]=(0,a.useState)(!1),[w,N]=(0,a.useState)(!1),[z,L]=(0,a.useState)(null);(0,a.useEffect)((()=>{n.e(44).then(n.bind(n,90044)).then((e=>{let{default:t}=e;L((()=>t))}))}),[]),(0,a.useEffect)((()=>{t||i()}),[t]);const D=async()=>{let t=e.filter((e=>h.includes(e.id)));E(!0),g(!0);const n=async()=>{if(t.length>0){const e=t.shift(),a=e.download_url;try{let o=new XMLHttpRequest;o.responseType="blob",o.open("get",a,!0),o.send(),o.onreadystatechange=function(){if(4===this.readyState&&200===this.status){let n=window.URL.createObjectURL(this.response),a=window.document.createElement("a");a.setAttribute("href",n),a.setAttribute("download",e.title),window.document.body.appendChild(a),a.click(),b(t),E(!1),g(!1),setTimeout((function(){window.URL.revokeObjectURL(n)}),6e4)}},await n()}catch(e){console.error(e),g(!1)}}};await n()},S=e=>{let t=[...e];return""!==p&&(t=t.filter((e=>e.region===p))),t.sort(((e,t)=>e.title<t.title?-1:e.title>t.title?1:0)),t.filter((e=>e.title.toLowerCase().includes(u.toLowerCase()))),t},I=[{name:(0,a.createElement)(c.default,{options:{true:""},indeterminate:y,value:w,onChange:t=>(t=>{if(t){N(!0);let t=v.currentPage?v.currentPage:1,n=S(e).slice(5*(t-1),5*t);b(n.map((e=>e.id)))}else N(!1),b([]);C(!1)})(t)}),selector:e=>e.selectControl,grow:1,minWidth:"50px"},{name:(0,r.__)("Document","complianz-gdpr"),selector:e=>e.title,sortable:!0,grow:6},{name:(0,r.__)("Region","complianz-gdpr"),selector:e=>(0,a.createElement)("img",{alt:"region",width:"20px",height:"20px",src:cmplz_settings.plugin_url+"assets/images/"+e.region+".svg"}),sortable:!0,grow:2,right:!0},{name:(0,r.__)("Date","complianz-gdpr"),selector:e=>e.date,sortable:!0,grow:4,right:!0,minWidth:"200px"}];let x=S(e),A=[];x.forEach((t=>{let n={...t};n.selectControl=(0,a.createElement)(c.default,{value:h.includes(n.id),options:{true:""},onChange:t=>((t,n)=>{let a=t,o=[...h];a?o.includes(n)||(o.push(n),b(o)):(o=[...h.filter((e=>e!==n))],b(o));let r=v.currentPage?v.currentPage:1,l=S(e).slice(5*(r-1),5*r),c=!0,i=!1;l.forEach((e=>{o.includes(e.id)?i=!0:c=!1})),c?(N(!0),C(!1)):i?(N(!1),C(!0)):C(!1)})(t,n.id)}),A.push(n)}));let O=h.length>1;return O||1!==h.length||(O=""!==e.filter((e=>h.includes(e.id)))[0].download_url),(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"cmplz-table-header"},(0,a.createElement)("div",{className:"cmplz-table-header-controls"},(0,a.createElement)("input",{className:"cmplz-datatable-search",type:"text",placeholder:(0,r.__)("Search","complianz-gdpr"),value:u,onChange:e=>m(e.target.value)}))),h.length>0&&(0,a.createElement)("div",{className:"cmplz-selected-document"},h.length>1&&(0,r.__)("%s items selected","complianz-gdpr").replace("%s",h.length),1===h.length&&(0,r.__)("1 item selected","complianz-gdpr"),(0,a.createElement)("div",{className:"cmplz-selected-document-controls"},(0,a.createElement)("button",{disabled:f||h.length>1,className:"button button-default",onClick:()=>d(h[0])},(0,r.__)("Edit","complianz-gdpr")),O&&(0,a.createElement)("button",{disabled:f,className:"button button-default cmplz-btn-reset",onClick:()=>D()},(0,r.__)("Download Data Breach Report","complianz-gdpr"),_&&(0,a.createElement)(l.default,{name:"loading",color:"grey"})),!O&&(0,a.createElement)("button",{disabled:!0,className:"button button-default cmplz-btn-reset",onClick:()=>D()},(0,r.__)("Reporting not required","complianz-gdpr")),(0,a.createElement)("button",{className:"button button-default cmplz-reset-button",onClick:()=>(async e=>{b([]),await s(e)})(h)},(0,r.__)("Delete","complianz-gdpr")))),z&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)(z,{columns:I,data:A,dense:!0,pagination:!0,paginationPerPage:5,onChangePage:e=>{k({...v,currentPage:e})},paginationState:v,noDataComponent:(0,a.createElement)("div",{className:"cmplz-no-documents"},(0,r.__)("No documents","complianz-gdpr")),persistTableHead:!0,theme:"really-simple-plugins",customStyles:{headCells:{style:{paddingLeft:"0",paddingRight:"0"}},cells:{style:{paddingLeft:"0",paddingRight:"0"}}}})))}))},39510:function(e,t,n){n.r(t);var a=n(30270),o=n(12902),r=n(48399),l=n(75169);const c=(0,a.Ue)(((e,t)=>({documentsLoaded:!1,savedDocument:{},conclusions:[],region:"",fileName:"",fetching:!1,updating:!1,loadingFields:!1,documents:[],regions:[],fields:[],editDocumentId:!1,resetEditDocumentId:t=>{e({editDocumentId:!1,region:""})},editDocument:async t=>{console.log(t),e({updating:!0}),await r.doAction("load_databreach_report",{id:t}).then((t=>{e({fields:t.fields,region:t.region,updating:!1,fileName:t.file_name})})).catch((e=>{console.error(e)})),e({editDocumentId:t})},setRegion:t=>{e({region:t})},updateField:(n,a)=>{let r=!1,c=!1;e((0,o.ZP)((e=>{e.fields.forEach((function(e,t){e.id===n&&(c=t,r=!0)})),!1!==c&&(e.fields[c].value=a)})));let i=(0,l.updateFieldsListWithConditions)(t().fields);e({fields:i})},save:async n=>{e({updating:!0});let a=t().editDocumentId,o=0;await r.doAction("save_databreach_report",{fields:t().fields,region:n,post_id:a}).then((t=>(o=t.post_id,e({updating:!1,conclusions:t.conclusions}),t))).catch((e=>{console.error(e)})),await t().fetchData();let l=t().documents.filter((e=>e.id===o));l.length>0&&e({savedDocument:l[0]})},deleteDocuments:async n=>{let a=t().documents.filter((e=>n.includes(e.id)));e((e=>({documents:e.documents.filter((e=>!n.includes(e.id)))})));let o={};o.documents=a,await r.doAction("delete_databreach_report",o).then((e=>e)).catch((e=>{console.error(e)}))},fetchData:async()=>{if(t().fetching)return;e({fetching:!0});const{documents:n,regions:a}=await r.doAction("get_databreach_reports",{}).then((e=>e)).catch((e=>{console.error(e)}));e((e=>({documentsLoaded:!0,documents:n,regions:a,fetching:!1})))},fetchFields:async t=>{let n={region:t};e({loadingFields:!0});const{fields:a}=await r.doAction("get_databreach_report_fields",n).then((e=>e)).catch((e=>{console.error(e)}));let o=(0,l.updateFieldsListWithConditions)(a);e((e=>({fields:o,loadingFields:!1})))}})));t.default=c},80881:function(e,t,n){n.r(t);var a=n(69307),o=n(48399),r=n(56293),l=n(82485),c=n(55609),i=n(32175),s=n(82387);t.default=(0,a.memo)((e=>{let{type:t="action",style:n="tertiary",label:d,onClick:u,href:m="",target:p="",disabled:f,action:g,field:h,children:b}=e;if(!d&&!b)return null;const _=(h&&h.button_text?h.button_text:d)||b,{fetchFieldsData:E,showSavedSettingsNotice:v}=(0,r.default)(),{setInitialLoadCompleted:k,setProgress:y}=(0,i.UseCookieScanData)(),{setProgressLoaded:C}=(0,s.default)(),{selectedSubMenuItem:w}=(0,l.default)(),[N,z]=(0,a.useState)(!1),L=`button cmplz-button button--${n} button-${t}`,D=async e=>{await o.doAction(h.action,{}).then((e=>{e.success&&(E(w),"reset_settings"===e.id&&(k(!1),y(0),C(!1)),v(e.message))}))},S=h&&h.warn?h.warn:"";return"action"===t?(0,a.createElement)(a.Fragment,null,c.__experimentalConfirmDialog&&(0,a.createElement)(c.__experimentalConfirmDialog,{isOpen:N,onConfirm:async()=>{z(!1),await D()},onCancel:()=>{z(!1)}},S),(0,a.createElement)("button",{className:L,onClick:async e=>{if("action"!==t||!u)return"action"===t&&g?c.__experimentalConfirmDialog?void(h&&h.warn?z(!0):await D()):void await D():void(window.location.href=h.url);u(e)},disabled:f},_)):"link"===t?(0,a.createElement)("a",{className:L,href:m,target:p},_):void 0}))},382:function(e,t,n){n.r(t),n.d(t,{default:function(){return D}});var a=n(69307),o=n(87462),r=n(99196),l=n(28771),c=n(25360),i=n(36206),s=n(77342),d=n(57898),u=n(7546),m=n(29115),p=n(75320);const f="Checkbox",[g,h]=(0,c.b)(f),[b,_]=g(f),E=(0,r.forwardRef)(((e,t)=>{const{__scopeCheckbox:n,name:a,checked:c,defaultChecked:d,required:u,disabled:m,value:f="on",onCheckedChange:g,...h}=e,[_,E]=(0,r.useState)(null),C=(0,l.e)(t,(e=>E(e))),w=(0,r.useRef)(!1),N=!_||Boolean(_.closest("form")),[z=!1,L]=(0,s.T)({prop:c,defaultProp:d,onChange:g}),D=(0,r.useRef)(z);return(0,r.useEffect)((()=>{const e=null==_?void 0:_.form;if(e){const t=()=>L(D.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}}),[_,L]),(0,r.createElement)(b,{scope:n,state:z,disabled:m},(0,r.createElement)(p.WV.button,(0,o.Z)({type:"button",role:"checkbox","aria-checked":k(z)?"mixed":z,"aria-required":u,"data-state":y(z),"data-disabled":m?"":void 0,disabled:m,value:f},h,{ref:C,onKeyDown:(0,i.M)(e.onKeyDown,(e=>{"Enter"===e.key&&e.preventDefault()})),onClick:(0,i.M)(e.onClick,(e=>{L((e=>!!k(e)||!e)),N&&(w.current=e.isPropagationStopped(),w.current||e.stopPropagation())}))})),N&&(0,r.createElement)(v,{control:_,bubbles:!w.current,name:a,value:f,checked:z,required:u,disabled:m,style:{transform:"translateX(-100%)"}}))})),v=e=>{const{control:t,checked:n,bubbles:a=!0,...l}=e,c=(0,r.useRef)(null),i=(0,d.D)(n),s=(0,u.t)(t);return(0,r.useEffect)((()=>{const e=c.current,t=window.HTMLInputElement.prototype,o=Object.getOwnPropertyDescriptor(t,"checked").set;if(i!==n&&o){const t=new Event("click",{bubbles:a});e.indeterminate=k(n),o.call(e,!k(n)&&n),e.dispatchEvent(t)}}),[i,n,a]),(0,r.createElement)("input",(0,o.Z)({type:"checkbox","aria-hidden":!0,defaultChecked:!k(n)&&n},l,{tabIndex:-1,ref:c,style:{...e.style,...s,position:"absolute",pointerEvents:"none",opacity:0,margin:0}}))};function k(e){return"indeterminate"===e}function y(e){return k(e)?"indeterminate":e?"checked":"unchecked"}const C=E,w=(0,r.forwardRef)(((e,t)=>{const{__scopeCheckbox:n,forceMount:a,...l}=e,c=_("CheckboxIndicator",n);return(0,r.createElement)(m.z,{present:a||k(c.state)||!0===c.state},(0,r.createElement)(p.WV.span,(0,o.Z)({"data-state":y(c.state),"data-disabled":c.disabled?"":void 0},l,{ref:t,style:{pointerEvents:"none",...e.style}})))}));var N=n(65736),z=n(23361),L=n(80881),D=(0,a.memo)((e=>{let{indeterminate:t,label:n,value:o,id:r,onChange:l,required:c,disabled:i,options:s={}}=e;const[d,u]=(0,a.useState)(!1),[m,p]=(0,a.useState)(!1);let f=o;Array.isArray(f)||(f=""===f?[]:[f]),(0,a.useEffect)((()=>{let e=1===Object.keys(s).length&&"true"===Object.keys(s)[0];u(e)}),[]),t&&(o=!0);const g=f;let h=!1;Object.keys(s).length>10&&(h=!0);const b=e=>d?o:g.includes(""+e)||g.includes(parseInt(e)),_=()=>{p(!m)};let E=i&&!Array.isArray(i);return 0===Object.keys(s).length?(0,a.createElement)(a.Fragment,null,(0,N.__)("No options found","complianz-gdpr")):(0,a.createElement)("div",{className:"cmplz-checkbox-group"},Object.entries(s).map(((e,s)=>{let[u,p]=e;return(0,a.createElement)("div",{key:u,className:"cmplz-checkbox-group__item"+(!m&&s>9?" cmplz-hidden":"")},(0,a.createElement)(C,{className:"cmplz-checkbox-group__checkbox",id:r+"_"+u,checked:b(u),"aria-label":n,disabled:E||Array.isArray(i)&&i.includes(u),required:c,onCheckedChange:e=>((e,t)=>{if(d)l(!o);else{const e=g.includes(""+t)||g.includes(parseInt(t))?g.filter((e=>e!==""+t&&e!==parseInt(t))):[...g,t];l(e)}})(0,u)},(0,a.createElement)(w,{className:"cmplz-checkbox-group__indicator"},(0,a.createElement)(z.default,{name:t?"indeterminate":"check",size:14,color:"dark-blue"}))),(0,a.createElement)("label",{className:"cmplz-checkbox-group__label",htmlFor:r+"_"+u},p))})),!m&&h&&(0,a.createElement)(L.default,{onClick:()=>_()},(0,N.__)("Show more","complianz-gdpr")),m&&h&&(0,a.createElement)(L.default,{onClick:()=>_()},(0,N.__)("Show less","complianz-gdpr")))}))},29115:function(e,t,n){n.d(t,{z:function(){return c}});var a=n(99196),o=n(91850),r=n(28771),l=n(9981);const c=e=>{const{present:t,children:n}=e,c=function(e){const[t,n]=(0,a.useState)(),r=(0,a.useRef)({}),c=(0,a.useRef)(e),s=(0,a.useRef)("none"),d=e?"mounted":"unmounted",[u,m]=function(e,t){return(0,a.useReducer)(((e,n)=>{const a=t[e][n];return null!=a?a:e}),e)}(d,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return(0,a.useEffect)((()=>{const e=i(r.current);s.current="mounted"===u?e:"none"}),[u]),(0,l.b)((()=>{const t=r.current,n=c.current;if(n!==e){const a=s.current,o=i(t);e?m("MOUNT"):"none"===o||"none"===(null==t?void 0:t.display)?m("UNMOUNT"):m(n&&a!==o?"ANIMATION_OUT":"UNMOUNT"),c.current=e}}),[e,m]),(0,l.b)((()=>{if(t){const e=e=>{const n=i(r.current).includes(e.animationName);e.target===t&&n&&(0,o.flushSync)((()=>m("ANIMATION_END")))},n=e=>{e.target===t&&(s.current=i(r.current))};return t.addEventListener("animationstart",n),t.addEventListener("animationcancel",e),t.addEventListener("animationend",e),()=>{t.removeEventListener("animationstart",n),t.removeEventListener("animationcancel",e),t.removeEventListener("animationend",e)}}m("ANIMATION_END")}),[t,m]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:(0,a.useCallback)((e=>{e&&(r.current=getComputedStyle(e)),n(e)}),[])}}(t),s="function"==typeof n?n({present:c.isPresent}):a.Children.only(n),d=(0,r.e)(c.ref,s.ref);return"function"==typeof n||c.isPresent?(0,a.cloneElement)(s,{ref:d}):null};function i(e){return(null==e?void 0:e.animationName)||"none"}c.displayName="Presence"},57898:function(e,t,n){n.d(t,{D:function(){return o}});var a=n(99196);function o(e){const t=(0,a.useRef)({value:e,previous:e});return(0,a.useMemo)((()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous)),[e])}}}]);