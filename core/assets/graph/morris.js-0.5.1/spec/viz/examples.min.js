var webpage=require("webpage"),fs=require("fs"),html_path=fs.absolute("test.html"),examples=[];function run_example(t){if(t>=examples.length)phantom.exit(0);else{var n=examples[t],o=0,a=webpage.create();a.viewportSize={width:500,height:300},a.clipRect={width:500,height:300},a.onAlert=function(e){var t=JSON.parse(e);"snapshot"==t.fn?(a.render("output/"+n.name+o+".png"),o+=1):"mousemove"==t.fn&&a.sendEvent("mousemove",t.x,t.y)},a.open(html_path,function(e){"fail"==e?(console.log("Failed to load test page: "+n.name),phantom.exit(1)):a.evaluate(n.runner),a.close(),run_example(t+1)})}}exports.def=function(e,t){examples.push({name:e,runner:t})},exports.run=function(){fs.isDirectory("output")?fs.list("output").forEach(function(e){"."!=e&&".."!=e&&fs.remove("output/"+e)}):fs.makeDirectory("output"),run_example(0)};