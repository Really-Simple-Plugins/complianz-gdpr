jQuery(document).ready(function(r){"use strict";function e(){r(".multiple-field").each(function(){var e=!0;r(this).find("input[type=text]").each(function(){""===r(this).val()&&(e=!1)}),r(this).find("textarea").each(function(){""===r(this).val()&&(e=!1)});var i=r(this).closest(".cmplz-panel").find(".cmplz-multiple-field-validation i");e?(i.removeClass("fa-times"),i.addClass("fa-check")):(i.addClass("fa-times"),i.removeClass("fa-check"))})}function i(){r(".cmplz-validate-multicheckbox").each(function(e){var i=[],t=!0;r(this).find(":checkbox").each(function(e){i.push(r(this)),r(this).is(":checked")&&(t=!1)});var n=r(this).closest(".field-group").find(".cmplz-label");t?(n.removeClass("valid-multicheckbox"),n.addClass("invalid-multicheckbox"),r.each(i,function(e,i){i.prop("required",!0),i.addClass("is-required")})):(n.removeClass("invalid-multicheckbox"),n.addClass("valid-multicheckbox"),r.each(i,function(e,i){i.prop("required",!1),i.removeClass("is-required")}))}),n()}function t(){r(".cmplz-validate-radio").each(function(e){var i=[],t=!0;r(this).find("input:radio").each(function(e){i.push(r(this)),r(this).is(":checked")&&(t=!1)});var n=r(this).closest(".field-group").find(".cmplz-label");t?(n.removeClass("valid-radio"),n.addClass("invalid-radio")):(n.removeClass("invalid-radio"),n.addClass("valid-radio"))}),n()}function n(){var o,d=!0;r(".condition-check").each(function(e){var i="cmplz_"+r(this).data("condition-question"),t="AND";if(null!=i){var n=r(this).data("condition-answer"),a=r(this).find("input[type=checkbox]");a.length||(a=r(this).find("input")),a.length||(a=r(this).find("textarea")),a.length||(a=r(this).find("select")),a.length&&a[0].hasAttribute("required")&&a.addClass("is-required"),d=-1===(n+="").indexOf("NOT ")||(n=n.replace("NOT ",""),!1);var c=[];-1!==n.indexOf(" OR ")?(c=n.split(" OR "),t="OR"):c=[n];var s=r(this),l=!1;c.forEach(function(e){if(o=function(e){if("text"==r("input[name^="+e+"]").attr("type"))return r("input[name^="+e+"]").val();var i=[];return r("input[name^="+e+"]:checked").each(function(){i[i.length]=r(this).val()}),i}(i),r("select[name="+i+"]").length&&(o=Array(r("select[name="+i+"]").val())),r("input[name='"+i+"["+e+"]']").length&&(l=!!r("input[name='"+i+"["+e+"]']").is(":checked"),o=[]),d){if(l||-1!=o.indexOf(e)||o==e)s.removeClass("hidden"),a.hasClass("is-required")&&a.prop("required",!0),"OR"===t&&(l=!0);else if(s.addClass("hidden"),a.hasClass("is-required")&&a.prop("required",!1),"OR"===t)return}else l||-1!=o.indexOf(e)||o==e?(s.addClass("hidden"),a.hasClass("is-required")&&a.prop("required",!1)):(s.removeClass("hidden"),a.hasClass("is-required")&&a.prop("required",!0))})}})}r(document).on("click",".cmplz-tablinks",function(){r(".cmplz-tablinks").removeClass("active"),r(this).addClass("active"),r(".cmplz-tabcontent").removeClass("active"),r("#"+r(this).data("tab")).addClass("active")}),window.setTimeout(function(){r(".cmplz-hide").fadeTo(500,0).slideUp(500,function(){r(this).remove()})},2e3),r(document).on("click",".cmplz-panel-toggle",function(){var e=r(this).closest(".cmplz-slide-panel").find(".cmplz-panel-content"),i=r(this).closest(".cmplz-slide-panel").find("i.toggle");e.is(":hidden")?(i.removeClass("fa-caret-right"),i.addClass("fa-caret-down"),e.slideDown("fast")):(e.slideUp("fast"),i.removeClass("fa-caret-down"),i.addClass("fa-caret-right"))}),r(document).on("click",".cmplz-open-modal",function(e){e.preventDefault();var i=r(this).closest(".field-group"),t=i.find(".cmplz-field"),n=i.find(".cmplz-help-modal");if(r(".cmplz-field").each(function(){r(this).css("float","none"),r(this).css("width","100%")}),r(".cmplz-help-modal").each(function(){r(this).hide(),r(this).parent().height(0)}),t.css("float","left"),t.css("width","60%"),!i.hasClass("cmplz-settings")){var a=t.height();n.height()>a&&(a=n.height()),a+=20,n.parent().height(a)}n.show()}),r(".cmplz-color-picker").wpColorPicker({change:function(e,i){var t=r(e.target).data("hidden-input");r("#"+t).val(i.color.toString())}}),r("#cmplz-support-form.hidden").hide().removeClass("hidden"),r(document).on("click","#cmplz-support-link",function(e){e.preventDefault();var i=r("#cmplz-support-form");i.is(":visible")?i.slideUp():i.slideDown()}),e(),r(document).on("keyup",".multiple-field input[type=text]",function(){e()}),r(document).on("keyup",".multiple-field textarea",function(){e()}),i(),r(".cmplz-validate-multicheckbox .is-required:checkbox").change(i),t(),r("input:radio").attr("required",!0).click(t),n(),r("input").change(function(e){n()}),r("select").change(function(e){n()}),r("textarea").change(function(e){n()});var a=1e4,c=complianz_admin.progress,s=r(".cmplz-progress-bar"),l=r(".detected-cookies");r("#cmplz-scan-progress").length&&(a=3e3),r("#cmplz_cookie_scan_frame").length&&function n(){var e=document.getElementById("cmplz_cookie_scan_frame");e.contentDocument||e.contentWindow.document,!l.find(".cmplz-loader").length&&c<100&&(l.html('<div class="cmplz-loader"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div>'),l.addClass("loader")),e.onload=function(){100<=c||r.get(complianz_admin.admin_url,{action:"cmplz_get_scan_progress"},function(e){var i;if(e){i=jQuery.parseJSON(e),c=parseInt(i.progress);var t=i.next_page;100<=c?(c=100,s.css({width:c+"%"}),r.ajax({type:"GET",url:complianz_admin.admin_url,dataType:"json",data:{action:"load_detected_cookies"},success:function(e){e.success&&(r(".detected-cookies").html(e.cookies),r(".detected-cookies.loader").removeClass("loader"))}})):(s.css({width:c+"%"}),r("#cmplz_cookie_scan_frame").attr("src",t),window.setTimeout(n,a))}})},window.setTimeout(n,a)}(),s.css({width:c+"%"}),r(document).on("click",".cmplz-add-to-policy",function(){var e,i,t,n,a,c=r(this).closest(".cmplz-slide-panel").find(".cmplz-title").html(),s=r(this).closest(".cmplz-slide-panel").find(".cmplz-panel-content").html();void 0===(n="cmplz_custom_privacy_policy_text")&&(n=wpActiveEditor),void 0===a&&(a=n),e=(jQuery("#wp-"+n+"-wrap").hasClass("tmce-active")&&tinyMCE.get(n)?tinyMCE.get(n).getContent():jQuery("#"+a).val())+"<h3>"+c+"</h3>"+s,void 0===(i="cmplz_custom_privacy_policy_text")&&(i=wpActiveEditor),void 0===t&&(t=i),jQuery("#wp-"+i+"-wrap").hasClass("tmce-active")&&tinyMCE.get(i)?tinyMCE.get(i).setContent(e):jQuery("#"+t).val(e),r(this).remove()});var o="#bar_pct_all_container";r(o).show(),r(document).on("change","select[name=cmplz_region]",function(){r(o).hide();var e=r("select[name=cmplz_region]").val(),i=r("select[name=stats_type]").val();r(o="#bar_"+i+"_"+e+"_container").fadeIn()}),r(document).on("change","select[name=stats_type]",function(){r(o).hide();var e="eu";r("select[name=cmplz_region]").length&&(e=r("select[name=cmplz_region]").val());var i=r("select[name=stats_type]").val();r(o="#bar_"+i+"_"+e+"_container").fadeIn()}),r(document).on("click","#cmplz-report-unknown-cookies",function(){r.ajax({type:"POST",url:complianz_admin.admin_url,dataType:"json",data:{action:"cmplz_report_unknown_cookies"},success:function(e){console.log(e),e.success&&(r("#cmplz-report-unknown-cookies").hide(),r("#cmplz-report-confirmation").show())}})}),function(){if(r("#cmplz_anonymous_window_warning").length){var e=window.RequestFileSystem||window.webkitRequestFileSystem;if(!e)return;e(window.TEMPORARY,100,function(e){},function(e){r("#cmplz_anonymous_window_warning").show()})}r("#cmplz_adblock_warning").length&&void 0===window.canRunAds&&r("#cmplz_adblock_warning").show()}()});